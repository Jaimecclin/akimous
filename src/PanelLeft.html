<div ref:panelLeft id="panel-left" class="{{focused?'indicator-on':''}} {{hidden?'gone':''}} {{autoHide?'auto-hide':''}}">
    <TabBar ref:tabBar id="tab-bar"></TabBar>
    <FileTree ref:fileTree></FileTree>
    <Outline ref:outline></Outline>
</div>


<style>
    #panel-left {
        position: fixed;
        top: var(--toolbar-height);
        left: 0;
        height: calc(100% - var(--toolbar-height));
        width: var(--panel-left-width);
        background: var(--panel-color);
        border-right: var(--panel-border);
        box-sizing: border-box;
        z-index: -5;
    }

</style>


<script>
    import g from './lib/Globals'
    import {
        setAttributeForMultipleComponent,
        activateView
    } from './lib/Utils'
    import TabBar from './panels/TabBar.html'
    import FileTree from './panels/FileTree.html'
    import Outline from './panels/Outline.html'

    export default {
        components: {
            TabBar,
            FileTree,
            Outline,
        },
        oncreate() {
            g.panelLeft = this
            this.tabBar = this.refs.tabBar
            setAttributeForMultipleComponent({
                parent: this
            }, this.refs.tabBar, this.refs.fileTree, this.refs.outline)

            let originalWidth
            this.observe('hidden', hidden => {
                if (hidden) {
                    originalWidth = this.refs.panelLeft.getBoundingClientRect().width
                    document.documentElement.style.setProperty('--panel-left-width', '0px')
                } else if (originalWidth)
                    document.documentElement.style.setProperty('--panel-left-width', originalWidth + 'px')
            })
            setTimeout(() => {
                this.activateView(this.refs.fileTree)
            })
        },
        data() {
            return {
                focused: false,
                hidden: false,
                autoHide: false
            }
        },
        methods: {
            activateView(view) {
                activateView(this, view)
            },
        }
    }

</script>
