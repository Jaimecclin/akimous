<div class="container {{active?'':'gone'}}">
    <div ref:macro id="macro">
        <table id="clipboard">
            {{#each clipboard as text, i}}
            <tr on:click="paste(text)">
                <td class="clipboard-index l-orange">{{(i+1)%10}}</td>
                <td>{{text}}</td>
            </tr>
            {{/each}}
        </table>
    </div>
</div>

<style>
    .container {
        height: calc(100% - var(--indicator-height) - .1rem);
    }

    #macro {}

    #clipboard {
        width: 100%;
    }

    table,
    th,
    td {
        border: none;
        padding: 0;
        margin: 0;
        border-spacing: 0;
        padding: .2rem 0 .2rem .2rem;
    }

    td {
        vertical-align: top;
        cursor: default;
        border-bottom: 1px solid var(--panel-delimiter-color);
    }

    tr:hover {
        background: var(--main-bg-color);
    }

    .clipboard-index {
        width: 1rem;
    }

</style>


<script>
    import g from '../lib/Globals'
    import {
        initializeTabView
    } from '../lib/Utils'

    export default {
        components: {},
        oncreate() {
            g.macro = this
            initializeTabView(this, 'Macro', 'fas fa-magic l-orange')
        },
        data() {
            return {
                active: false,
                clipboard: [
                    'import numpy',
                    'def'
                ]
            }
        },
        methods: {
            addClipboardItem(text) {
                const clipboard = this.get('clipboard')
                if (clipboard.length >= 10) clipboard.pop()
                clipboard.unshift(text)
                this.set({
                    clipboard
                })
            },
            paste(text) {
                const editor = g.activeEditor
                if (!editor) return
                editor.cm.replaceSelection(text)
            },
            dispatchMacro(key) {
                let number = +key
                if (Number.isInteger(number)) {
                    if (number === 0) number = 10
                    this.paste(this.get('clipboard')[number - 1])
                }
            }
        }
    }

</script>
