<div ref:tabNumberHint id="tab-number-hint" class:gone="!active">
    {#each numberOffsets as offset, i} {#if i < 9} 
       <span class="number l-orange" style="left:{offset}px">{i + 1}</span>
    {/if} {/each}
</div>


<style>
    #tab-number-hint {
        position: absolute;
        top: 0;
        height: calc(var(--toolbar-height) - var(--panel-border-thickness));
        width: 100%;
        z-index: 220;
        background: var(--panel-color);
    }

    .number {
        position: absolute;
        line-height: var(--toolbar-height);
        width: 30px;
        text-align: center;
    }

</style>


<script>
    import g from '../lib/Globals'

    export default {
        components: {},
        oncreate() {
            g.tabNumber = this
        },
        onstate({ changed, current }) {
            if (changed.active) {
                if (!current.active) return
                const activePanel = g.focusStack[0]
                if (!activePanel) return
                let children = activePanel.tabBar.refs.tabBar.childNodes
                // remove resizeSensor
                children = [...children].filter(child => child.classList.contains('tab'))
                if (children.length < 2) {
                    this.set({
                        active: false
                    })
                }
                this.set({
                    numberOffsets: children.map(tab => {
                        const rect = tab.getBoundingClientRect()
                        return (rect.left + rect.right) / 2 - 15
                    })
                })
            }
        },
        data() {
            return {
                active: false,
                numberOffsets: []
            }
        },
        methods: {}
    }

</script>
