{#if active}
<div id="prompt-modal" class="popup">
    <div class="icon-area">
        <i class="icon {icon}" aria-hidden="true"></i>
    </div>
    <div class="text">{@html content}</div>
    <table class="non-selectable">
        <tr>
            {#each buttons as button}
            <td class="td {button.style}" on:click="onClickButton(button)"> {button.text} </td>
            {/each}
        </tr>
    </table>
</div>
{/if}

<style>
    #prompt-modal {
        width: var(--prompt-width);
        top: calc(var(--toolbar-height) * 2 + .07rem);
        left: calc(50vw - 20rem);
        font-size: var(--ui-font-size-large);
        padding: 2rem;
        cursor: default;
        z-index: 920;
    }

    .icon-area {
        font-size: 4rem;
        width: 4rem;
        height: 5rem;
        top: 1.7rem;
        text-align: right;
        position: absolute;
    }

    :global(#prompt-modal > .text > em) {
        color: var(--ui-highlight-color);
        font-style: normal;
        font-weight: bold;
    }

    .text {
        left: 6rem;
        padding-bottom: 2rem;
        top: 0;
        width: calc(100% - 6rem);
        position: relative;
    }

    table {
        table-layout: fixed;
        left: 0;
        width: var(--prompt-width);
        height: 3rem;
        position: absolute;
        border-radius: .5rem;
        -webkit-border-horizontal-spacing: 0;
        -webkit-border-vertical-spacing: 0;
    }

    td {
        background: var(--brighter-ui-font-color);
        color: var(--ui-prompt-color);
        font-size: var(--ui-font-size-large);
        text-align: center;
        font-weight: bold;
    }

    td:hover {
        filter: brightness(110%);
    }

    table tr:last-child td:first-child {
        border-bottom-left-radius: .5rem;
    }

    table tr:last-child td:last-child {
        border-bottom-right-radius: .5rem;
    }

    .success {
        background: var(--brighter-green);
        color: var(--gray9);
    }

    .dismiss {
        background: var(--gray7);
        color: var(--primary2);
    }

    .danger {
        background: var(--brighter-red);
        color: var(--gray9);
    }

</style>


<script>
    import g from '../lib/Globals'

    export default {
        components: {},
        oncreate() {
            g.prompt = this
            this.queue = []
        },
        data() {
            return {
                active: false,
                icon: 'far fa-question-circle',
                content: '',
                buttons: [{
                    text: 'Yes',
                    style: 'success'
                }, {
                    text: 'No',
                    style: 'danger'
                }]
            }
        },
        methods: {
            open(data) {
                this.queue.push(data)
                if (this.queue.length == 1) {
                    this.set(data)
                }
                this.set({
                    active: true
                })
                g.activeEditor && g.activeEditor.completion.set({
                    open: false
                })
            },
            onClickButton(button) {
                button.action && button.action()
                this.queue.shift()
                if (this.queue.length != 0) {
                    this.set(this.queue[0])
                    return
                }
                this.set({
                    active: false
                })
            }
        }
    }

</script>
